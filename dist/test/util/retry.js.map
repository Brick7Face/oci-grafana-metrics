{"version":3,"sources":["../../../src/util/retry.js"],"names":["retryOrThrow","actionPromise","maxRetries","numberOfRetries","Promise","resolve","reject","action","then","response","catch","error","Error","delay","Math","pow","floor","random","setTimeout"],"mappings":";;;;;kBAAwBA,Y;AAAT,SAASA,YAAT,CAAuBC,aAAvB,EAAsCC,UAAtC,EAAkD;AAC/D,MAAIC,kBAAkB,CAAtB;AACA,SAAO,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AACtCC;AACA,aAASA,MAAT,GAAmB;AACjBN,sBACGO,IADH,CACQ,UAACC,QAAD,EAAc;AAClBJ,gBAAQI,QAAR;AACD,OAHH,EAIGC,KAJH,CAIS,UAACC,KAAD,EAAW;AAChB,YAAIR,mBAAmBD,UAAvB,EAAmC;AACjC,iBAAOI,OAAO,IAAIM,KAAJ,wCAA+CD,KAA/C,CAAP,CAAP;AACD;AACD,YAAIE,QAAQC,KAAKC,GAAL,CAAS,CAAT,EAAYZ,eAAZ,IAA+BW,KAAKE,KAAL,CAAWF,KAAKG,MAAL,KAAgB,IAA3B,CAA3C;AACAd;AACAe,mBAAW;AAAA,iBAAMX,QAAN;AAAA,SAAX,EAA2BM,KAA3B;AACD,OAXH,EAYGH,KAZH,CAYSJ,MAZT;AAaD;AACF,GAjBM,CAAP;AAkBD","file":"retry.js","sourcesContent":["export default function retryOrThrow (actionPromise, maxRetries) {\n  let numberOfRetries = 1\n  return new Promise((resolve, reject) => {\n    action()\n    function action () {\n      actionPromise()\n        .then((response) => {\n          resolve(response)\n        })\n        .catch((error) => {\n          if (numberOfRetries >= maxRetries) {\n            return reject(new Error(`reject: too many failed attempts: ${error}`))\n          }\n          let delay = Math.pow(2, numberOfRetries) + Math.floor(Math.random() * 1000)\n          numberOfRetries++\n          setTimeout(() => action(), delay)\n        })\n        .catch(reject)\n    }\n  })\n}\n"]}